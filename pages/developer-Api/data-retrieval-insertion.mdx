---
title: Profile Data and Enrichment
---
import ApiSection from '../../src/app/_components/developerApiContent/apiTester'
import { Callout, Steps } from 'nextra/components'

# Profile Data and Enrichment

This page explains how brand teams build a consent-first profile pipeline using MuleSoft agentic APIs and optional Plaid signals.

## The data pipeline

<Steps>
### 1) Consent and identity
Collect the minimum identifiers required for enrichment and request user consent.

### 2) Profile creation or query
Create a new profile or retrieve an existing one from Supabase.

### 3) Public and Gemini enrichment
Generate a complete profile with public data and high-confidence gap filling.

### 4) Brand preference normalization
Translate signals into likes, dislikes, and brand affinities for CRM activation.

### 5) Activation
Store the merged profile in your CRM, CDP, or personalization system.
</Steps>

## MuleSoft flow

MuleSoft orchestrates the agent chain, applies retry logic, and normalizes responses through DataWeave before data is stored or activated.

## Plaid signals (optional)

Plaid is used to enrich merchant and category signals that strengthen brand affinity modeling.

<Callout type="warning">
Plaid calls must be server to server. Do not run Plaid endpoints from the browser.
</Callout>

Common Plaid endpoints in this flow:

- `POST /link/token/create`
- `POST /item/public_token/exchange`
- `POST /accounts/get`
- `POST /transactions/sync`
- `POST /identity/get` (if identity is consented)

Map Plaid outputs into brand affinity fields before calling the Brand agent.

## Testable endpoints

### Supabase Profile Creation Agent

<ApiSection
  endpoint={{
    method: "POST",
    path: "/api/a2a/hushh-profile",
    description: "Create a Supabase profile",
    requestBody: {
      text: {
        type: "string",
        example:
          "Create a profile for Sundar Pichai with email sundar.pichai@example.com, phone +1 6505559001, occupation CEO, city Mountain View, and country USA."
      },
      sessionId: { type: "string" },
      id: { type: "string" }
    }
  }}
/>

### Supabase Profile Update Agent

<ApiSection
  endpoint={{
    method: "POST",
    path: "/api/a2a/hushh-profile-update",
    description: "Update an existing Supabase profile",
    requestBody: {
      text: {
        type: "string",
        example:
          "Update the city for Sundar Pichai to Mountain View and set the occupation to CEO."
      },
      sessionId: { type: "string" },
      id: { type: "string" }
    }
  }}
/>

### Supabase Profile Query Agent

<ApiSection
  endpoint={{
    method: "POST",
    path: "/api/a2a/hushh",
    description: "Query a Supabase profile by phone or email",
    requestBody: {
      text: {
        type: "string",
        example: "Fetch all details for Sundar Pichai with phone +1 6505559001."
      },
      sessionId: { type: "string" },
      id: { type: "string" }
    }
  }}
/>

### OpenAI Public Data Agent

<ApiSection
  endpoint={{
    method: "POST",
    path: "/api/a2a/public",
    description: "Public data enrichment",
    requestBody: {
      text: {
        type: "string",
        example:
          "Provide a detailed JSON profile for Sundar Pichai, email sundar.pichai@example.com, phone +1 6505559001."
      },
      sessionId: { type: "string" },
      id: { type: "string" }
    }
  }}
/>

### Gemini Public Data Agent

<ApiSection
  endpoint={{
    method: "POST",
    path: "/api/a2a/gemini",
    description: "Second-pass enrichment",
    requestBody: {
      text: {
        type: "string",
        example:
          "Using the Gemini Public Data Agent, provide a detailed JSON profile for Sundar Pichai with email sundar.pichai@example.com and phone +1 6505559001, including demographics, lifestyle, and intent fields."
      },
      sessionId: { type: "string" },
      id: { type: "string" }
    }
  }}
/>

### Brand User Data Query Agent

<ApiSection
  endpoint={{
    method: "POST",
    path: "/api/a2a/brand",
    description: "Normalize likes, dislikes, and brand affinities",
    requestBody: {
      text: {
        type: "string",
        example: "Summarize likes, dislikes, and brand affinity for Sundar Pichai using the consented profile."
      },
      sessionId: { type: "string" },
      id: { type: "string" }
    }
  }}
/>

## Quickstart prompts (paste into the Api Tester)

Use these prompts in the `text` field for the endpoints above.

### Create a profile (Supabase Profile Creation Agent)

```
Create a profile for Sundar Pichai with email sundar.pichai@example.com, phone +1 6505559001, occupation CEO, city Mountain View, and country USA.
```

### Update a profile (Supabase Profile Update Agent)

```
Update the city for Sundar Pichai to Mountain View and set the occupation to CEO.
```

### Query an existing profile (Supabase Profile Query Agent)

```
Fetch all details for Sundar Pichai with phone +1 6505559001.
```

### Enrich with OpenAI Public Data Agent

```
Provide a detailed JSON profile for Sundar Pichai, email sundar.pichai@example.com, phone +1 6505559001.
```

### Enrich with Gemini Public Data Agent

```
Using the Gemini Public Data Agent, provide a detailed JSON profile for Sundar Pichai with email sundar.pichai@example.com and phone +1 6505559001, including demographics, lifestyle, and intent fields.
```

### Normalize brand affinities (Brand User Data Query Agent)

```
Summarize likes, dislikes, and brand affinity for Sundar Pichai using the consented profile.
```

## Example merged profile output

```json
{
  "fullName": "Sundar Pichai",
  "email": "sundar.pichai@example.com",
  "phone": "+1 6505559001",
  "likes": ["fine leather goods", "limited drops", "Paris fashion week"],
  "dislikes": ["fast fashion", "discount-only messaging"],
  "brand_affinities": ["Dior", "Louis Vuitton", "Sephora"],
  "shopping_preferences": {
    "category_focus": ["handbags", "beauty", "fragrance"],
    "price_sensitivity": "low",
    "channel": "in-store and VIP events"
  },
  "confidence": 0.86
}
```
